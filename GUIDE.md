# GeoscientistToolkit User Guide

![GeoscientistToolkit Logo](image.png)

## Table of Contents

1. [Introduction](#introduction)
2. [Getting Started](#getting-started)
3. [Core Concepts](#core-concepts)
4. [Data Types and Formats](#data-types-and-formats)
5. [User Interface](#user-interface)
6. [Analysis Modules](#analysis-modules)
7. [GeoScript Scripting Language](#geoscript-scripting-language)
8. [Advanced Features](#advanced-features)
9. [Technical Reference](#technical-reference)

---

## Introduction

### What is GeoscientistToolkit?

GeoscientistToolkit is a comprehensive desktop application for advanced geoscientific data analysis and simulation. Built on .NET 8.0, it provides an integrated environment for working with diverse geophysical and geochemical datasets, from seismic surveys to microscale rock analysis.

The application combines interactive 3D visualization, GPU-accelerated simulations, and a domain-specific scripting language to enable sophisticated workflows across multiple geoscience disciplines.

### Key Capabilities

- Multi-scale analysis from pore-scale (micrometers) to basin-scale (kilometers)
- Real-time 3D visualization using modern graphics APIs
- GPU-accelerated simulations for geomechanics, geothermal systems, and reactive transport
- Comprehensive thermodynamic and chemical databases
- Automated workflows through GeoScript programming language
- Support for industry-standard formats (SEGY, LAS, Shapefiles, Excel, TIFF)

### Target Users

This software is designed for:
- Geoscientists and researchers analyzing subsurface data
- Reservoir engineers modeling flow and transport
- Geothermal engineers designing energy systems
- Petrophysicists characterizing rock properties
- Geomechanical engineers simulating stress and deformation
- Environmental scientists studying contaminant transport

---

## Getting Started

### Installation

The application is distributed as a cross-platform executable supporting:
- Windows (x64)
- macOS (ARM64 and x86_64)
- Linux (x64)

No installation is required. Simply extract and run the executable.

### System Requirements

**Minimum:**
- 8 GB RAM
- Dedicated graphics card with OpenGL 3.3+ or DirectX 11 support
- 2 GB available disk space

**Recommended:**
- 16 GB+ RAM
- GPU with OpenCL 1.2+ support for accelerated simulations
- 10 GB+ available disk space for large datasets
- Multi-core processor for parallel operations

### First Launch

On first launch, the application will:
1. Initialize graphics subsystem (Veldrid with ImGui)
2. Load application settings
3. Display the main window with default layout
4. Show the welcome screen

You can immediately begin by importing data through the File menu or creating a new project.

### Opening a Project

Projects are saved as `.gtp` files (zipped archives containing data and metadata).

To open a project:
1. Go to File > Open Project
2. Select a `.gtp` file
3. The application will extract and load all datasets

You can also pass a `.gtp` file as a command-line argument:
```bash
./GeoscientistToolkit myproject.gtp
```

---

## Core Concepts

### Projects

A project is a collection of datasets with associated metadata. Projects are persisted as `.gtp` files containing:
- Dataset references and metadata
- Binary data files (images, volumes, tables)
- Material definitions and properties
- Analysis configurations

Projects support auto-save functionality with configurable intervals.

### Datasets

Everything in GeoscientistToolkit is a dataset. A dataset represents a discrete unit of geoscientific data with:
- **Type**: One of 27 supported types (CT volumes, images, tables, boreholes, etc.)
- **Name**: User-defined identifier
- **Metadata**: Creation date, source, location, sample information
- **Data**: The actual content (varies by type)

Datasets can be:
- Loaded from files
- Created through analysis operations
- Generated by scripts
- Exported to standard formats

### Materials

Materials represent physical substances with properties including:
- Density (kg/m³)
- Porosity (fraction)
- Color (RGBA for visualization)
- Thermal properties (conductivity, heat capacity)
- Mechanical properties (Young's modulus, Poisson ratio)

Materials are assigned to voxels in CT volumes or elements in meshes for property-based simulations.

### Metadata

All datasets support comprehensive metadata:
- Sample name and description
- Collection date and time
- Geographic location (latitude/longitude)
- Collector name
- Custom key-value pairs

Metadata is preserved through analysis workflows and export operations.

---

## Data Types and Formats

### Supported Dataset Types

#### CT Image Stack
Three-dimensional volumetric data from computed tomography scanners.

**Use cases:**
- Rock core analysis
- Pore structure characterization
- Material segmentation
- Volume rendering

**File formats:**
- TIFF sequences
- Raw binary volumes
- Custom CT formats

**Key features:**
- Multi-material segmentation
- 3D selection tools (magic wand, brush, lasso)
- Material statistics
- Export to mesh formats

**File reference:** `/Data/CtImageStack/CtImageStackDataset.cs`

#### Single Image
Two-dimensional raster images with support for layers and selections.

**Use cases:**
- Thin section analysis
- Surface texture mapping
- Image processing
- Feature extraction

**File formats:**
- PNG, JPEG, TIFF, BMP
- Multi-page TIFF

**Key features:**
- Selection tools
- Layer management
- Histogram analysis
- Image filters

**File reference:** `/Data/Image/ImageDataset.cs`

#### Table
Tabular data with columns and rows.

**Use cases:**
- Analytical results
- Well log data
- Time series
- Statistical analysis

**File formats:**
- CSV, TSV
- Excel (.xls, .xlsx)

**Key features:**
- Column statistics
- Filtering and sorting
- Aggregation operations
- Export to Excel

**File reference:** `/Data/Table/TableDataset.cs`

#### GIS (Geographic Information System)
Vector-based geospatial data.

**Use cases:**
- Well location mapping
- Subsurface feature mapping
- Regional analysis
- Spatial queries

**File formats:**
- ESRI Shapefiles
- GeoJSON
- GDAL-supported formats

**Key features:**
- Multi-layer support
- Coordinate transformations
- Spatial operations
- Attribute tables

**File reference:** `/Data/GIS/GISDataset.cs`

#### Borehole
Well log data with depth-indexed properties.

**Use cases:**
- Stratigraphic analysis
- Lithology correlation
- Well path visualization
- Formation evaluation

**File formats:**
- Custom borehole formats
- LAS (Log ASCII Standard)

**Key features:**
- Lithology intervals
- Stratigraphic correlation
- Multi-borehole visualization
- Formation tops

**File reference:** `/Data/Borehole/BoreholeDataset.cs`

#### Pore Network Model (PNM)
Graph-based representation of pore space.

**Use cases:**
- Permeability calculation
- Multiphase flow simulation
- Reactive transport modeling
- Pore-scale characterization

**Data structure:**
- Pores (nodes with volume, area)
- Throats (edges with radius, length)
- Connectivity matrix

**Key features:**
- Absolute permeability solver
- Dual-PNM (macro/micro coupling)
- Reactive transport
- Network statistics

**File reference:** `/Data/Pnm/PoreNetworkModelDataset.cs`

#### Seismic
Reflection/refraction seismic survey data.

**Use cases:**
- Subsurface imaging
- Structural interpretation
- Velocity analysis
- Amplitude studies

**File formats:**
- SEGY (SEG-Y standard)

**Key features:**
- Trace visualization
- Header parsing
- Amplitude analysis
- Integration with well data

**File reference:** `/Data/Seismic/SeismicDataset.cs`

#### 3D Mesh
Triangulated surface or volumetric meshes.

**Use cases:**
- Geometric modeling
- Finite element simulation
- Surface representation
- Visualization

**File formats:**
- OBJ
- STL
- Custom mesh formats

**File reference:** `/Data/Mesh3D/Mesh3DDataset.cs`

#### Acoustic Volume
Three-dimensional acoustic/seismic wave propagation results.

**Use cases:**
- Wave simulation visualization
- Acoustic property analysis
- Seismic forward modeling

**File reference:** `/Data/AcousticVolume/AcousticVolumeDataset.cs`

#### PhysicoChem
Thermodynamic and chemical property data.

**Use cases:**
- Phase diagram calculation
- Equilibrium speciation
- Activity coefficient computation

**File reference:** `/Data/PhysicoChem/PhysicoChemDataset.cs`

#### Point Cloud
Three-dimensional scattered point data.

**File formats:**
- LAS (LASer scanning)
- LAZ (compressed LAS)

**File reference:** `/Data/PointCloud/PointCloudDataset.cs`

#### Video and Audio
Multimedia datasets.

**File formats:**
- Video: MP4, AVI (via FFMpeg)
- Audio: WAV, OGG

**File references:**
- `/Data/Media/VideoDataset.cs`
- `/Data/Media/AudioDataset.cs`

#### Text
Plain text file datasets.

**File formats:**
- TXT
- Any text-based format

**File reference:** `/Data/Text/TextDataset.cs`

---

## User Interface

### Main Window Layout

The main window uses an ImGui docking interface with the following default panels:

```
+-----------------------------------------------------------+
| Menu Bar: File | Edit | View | Tools | Help              |
+-----------------------------------------------------------+
| +-------------+  +-------------------+  +-------------+   |
| | Datasets    |  | Viewer Window     |  | Properties  |   |
| | Panel       |  |                   |  | Panel       |   |
| |             |  | (Interactive 3D)  |  |             |   |
| | - Dataset 1 |  |                   |  | Name:       |   |
| | - Dataset 2 |  +-------------------+  | Type:       |   |
| | - Dataset 3 |  +-------------------+  | Size:       |   |
| |             |  | Viewer Window 2   |  | Created:    |   |
| | Tools Panel |  |                   |  | Metadata... |   |
| +-------------+  +-------------------+  +-------------+   |
| +-------------------------------------------------------+ |
| | Log Panel (Messages, Warnings, Errors)                | |
| +-------------------------------------------------------+ |
+-----------------------------------------------------------+
```

All panels are dockable and can be rearranged, resized, or closed.

### Datasets Panel

Located on the left sidebar by default, this panel shows:
- Hierarchical list of all loaded datasets
- Dataset type icons
- Selection state (click to select, multi-select with Ctrl)
- Right-click context menu for operations

**Operations:**
- View: Open a viewer window
- Properties: Show detailed properties
- Remove: Delete from project
- Export: Save to file
- Duplicate: Create a copy

### Properties Panel

Shows detailed information about the selected dataset:
- Basic metadata (name, type, size)
- Creation and modification dates
- File path (if loaded from disk)
- Custom metadata fields
- Type-specific properties

Editable fields can be modified directly in this panel.

### Viewer Windows

Each dataset type has a specialized viewer:

**CT Volume Viewer:**
- 3D rendering with raycasting
- Slice views (XY, XZ, YZ planes)
- Material coloring
- Segmentation overlay
- Transfer function editor

**Image Viewer:**
- Zoom and pan
- Layer visibility
- Selection tools overlay
- Histogram display

**Table Viewer:**
- Spreadsheet-like grid
- Sortable columns
- Filter controls
- Statistics display

**GIS Viewer:**
- 2D map view
- Layer management
- Feature selection
- Attribute inspection

**Borehole Viewer:**
- Vertical log display
- Lithology intervals
- Track plots
- Correlation lines

### Tools Panel

Context-sensitive tools appear based on the selected dataset type:

**CT Image Stack Tools:**
- Segmentation: Magic Wand, Brush, Lasso, Fill
- Volume extraction
- Material assignment
- Statistics calculation

**Image Tools:**
- Selection: Rectangle, Ellipse, Polygon
- Filters: Blur, Sharpen, Threshold
- Color adjustments

**Table Tools:**
- Filter builder
- Column operations
- Aggregation

**GIS Tools:**
- Spatial query
- Buffer operations
- Intersection/Union

### Log Panel

Displays application messages:
- Information: General status messages
- Warning: Non-critical issues
- Error: Operation failures

Color-coded for quick identification. Messages include timestamps and can be filtered by level.

### Menu Bar

**File Menu:**
- New Project
- Open Project
- Save Project / Save As
- Import Data
- Export Selected
- Recent Projects
- Exit

**Edit Menu:**
- Undo / Redo (where supported)
- Copy / Paste
- Preferences

**View Menu:**
- Show/Hide panels
- Reset Layout
- Fullscreen

**Tools Menu:**
- GeoScript Editor
- Material Library
- Compound Library
- System Info
- Settings

**Help Menu:**
- Documentation
- About

### Specialized Windows

#### Settings Window
Configure application behavior:
- Graphics backend selection (D3D11, Vulkan, OpenGL, Metal)
- Auto-save interval
- Default paths
- UI theme
- Performance options

**File reference:** `/Settings/Settings.cs`

#### Material Library Window
Manage physical materials:
- Create/edit materials
- Assign properties
- Color selection
- Import/export material definitions

#### Compound Library Window
Browse and edit thermodynamic database:
- 100+ minerals and aqueous species
- Thermodynamic properties (ΔGf, ΔHf, S, Cp)
- Solubility products
- Kinetic parameters

**File reference:** `/Business/CompoundLibrary.cs`

#### GeoScript Editor
Write and execute scripts:
- Syntax highlighting
- Command completion
- Variable inspection
- Execution log

#### System Info Window
Display system capabilities:
- CPU information
- Memory usage
- Graphics device details
- OpenCL devices (if available)

---

## Analysis Modules

GeoscientistToolkit includes 22 specialized analysis modules for different geoscience domains.

### Pore Network Modeling

#### PNM Generation
Extract pore networks from CT volumes.

**Process:**
1. Load segmented CT volume
2. Select material representing pore space
3. Run PNM generator
4. Adjust parameters (pore detection threshold, throat calculation method)
5. Generate network dataset

**Outputs:**
- Pore Network Model dataset
- Network statistics (coordination number, pore/throat size distributions)

**File reference:** `/Analysis/PNM/PNMGenerator.cs`

#### Absolute Permeability Calculation
Compute Darcy permeability from pore network.

**Method:**
- Solves pressure field using network conductances
- Applies pressure gradient
- Calculates total flux
- Reports permeability tensor (kx, ky, kz)

**File reference:** `/Analysis/PNM/AbsolutePermeability.cs`

#### Reactive Transport in PNM
Simulate chemical reactions in pore networks.

**Capabilities:**
- Multi-species transport (advection + diffusion)
- Mineral dissolution/precipitation
- Kinetic rate laws
- Porosity and permeability evolution
- Solid solution models

**Example workflow:**
1. Generate PNM from CT scan
2. Define chemical system (species: Ca2+, CO3-2; minerals: calcite)
3. Set initial concentrations and boundary conditions
4. Run simulation with time stepping
5. Visualize concentration fields and mineral amounts
6. Analyze permeability changes

**File reference:** `/Analysis/PNM/PNMReactiveTransport.cs`

#### Dual-PNM Systems
Couple macro-pore and micro-pore networks.

**Use case:** Rocks with dual porosity (fractures + matrix)

**Features:**
- Separate macro and micro networks
- Transfer terms between scales
- Enhanced oil recovery simulations
- Hierarchical flow modeling

**File reference:** `/Analysis/PNM/DualPNMGenerator.cs`

### Geothermal Analysis

#### Geothermal System Simulation
Model heat extraction from subsurface.

**Components:**
- Borehole heat exchangers
- Aquifer layers
- Heat sources/sinks
- Working fluid properties

**Solver options:**
- CPU-based finite difference
- GPU-accelerated (OpenCL)
- Time-varying boundary conditions

**Outputs:**
- Temperature field evolution
- Heat extraction rates
- Thermal interference between wells
- Economic analysis (payback period)

**File reference:** `/Analysis/Geothermal/GeothermalSimulationSolver.cs`

#### Borehole Thermal Energy Storage (BTES)
Simulate seasonal heat storage.

**Workflow:**
1. Define borehole geometry (depth, radius, spacing)
2. Set geological layers (thermal conductivity, capacity)
3. Define injection/extraction schedule
4. Run multi-year simulation
5. Analyze storage efficiency

**File reference:** `/Analysis/Geothermal/GeothermalSimulationTools.cs`

#### Organic Rankine Cycle (ORC) Analysis
Evaluate power generation efficiency.

**Features:**
- Working fluid selection (R245fa, isobutane, etc.)
- Thermodynamic cycle calculation
- Heat exchanger modeling
- Turbine/pump efficiency

**File reference:** `/Analysis/Geothermal/ORCSimulation.cs`

### Geomechanical Analysis

#### Triaxial Testing Simulation
Virtual rock mechanics testing.

**Test types:**
- Conventional triaxial (constant confining pressure)
- True triaxial (independent σ1, σ2, σ3)
- Uniaxial compression

**Physics:**
- Elastic-plastic constitutive model
- Damage mechanics (scalar damage variable)
- Mohr-Coulomb failure criterion
- Strain softening/hardening

**Outputs:**
- Stress-strain curves
- Failure envelope
- Damage distribution
- Mohr circles at failure

**File references:**
- `/Analysis/Geomechanics/TriaxialSimulationTool.cs`
- `/Analysis/Geomechanics/GeomechanicalSimulationCPU.cs`
- `/Analysis/Geomechanics/GeomechanicalSimulationGPU.cs`

#### Geomechanical Property Calibration
Fit elastic properties to experimental data.

**Method:**
- Load experimental stress-strain data
- Define parameter bounds (E, ν, cohesion, friction angle)
- Run optimization (least squares)
- Export calibrated properties

**File reference:** `/Analysis/Geomechanics/MechanicalPropertyCalibration.cs`

### Thermodynamic Analysis

#### Chemical Equilibrium Solver
Calculate aqueous speciation.

**Inputs:**
- Total element concentrations
- Temperature and pressure
- pH (or charge balance)

**Outputs:**
- Species concentrations
- Mineral saturation indices
- pH and Eh
- Activity coefficients

**File reference:** `/Analysis/Thermodynamic/ThermodynamicSolver.cs`

#### Phase Diagram Generation
Compute stability fields for minerals.

**Diagram types:**
- Activity-activity (e.g., log[Ca2+] vs log[CO3-2])
- Temperature-pressure
- Temperature-composition

**File reference:** `/Analysis/Thermodynamic/PhaseDiagramGenerator.cs`

#### Reactive Transport (Continuum)
Simulate reaction and transport in porous media.

**Governing equations:**
- Advection-diffusion for solutes
- Reaction kinetics for minerals
- Porosity update from volume changes

**Capabilities:**
- 1D, 2D, or 3D grids
- Multi-component systems
- Temperature coupling
- Output time series

**File reference:** `/Analysis/Thermodynamic/ReactiveTransportSolver.cs`

### Seismic and Acoustic Analysis

#### Wave Propagation Simulation
Forward modeling of seismic waves.

**Method:**
- Finite difference time domain (FDTD)
- Elastic wave equation
- Absorbing boundary conditions

**Inputs:**
- Velocity model (Vp, Vs)
- Source location and wavelet
- Receiver positions

**Outputs:**
- Acoustic volume (3D wavefield snapshots)
- Synthetic seismograms

**File reference:** `/Analysis/Seismology/WavePropagationEngine.cs`

#### Earthquake Simulation
Model crustal deformation and seismicity.

**Features:**
- Fault geometry definition
- Stress accumulation
- Dynamic rupture
- Ground motion calculation

**File reference:** `/Analysis/Seismology/EarthquakeSimulationEngine.cs`

#### SEGY Processing
Standard seismic data handling.

**Operations:**
- Load SEGY files
- Parse trace headers
- Extract inline/crossline sections
- Amplitude analysis

**File reference:** `/Data/Seismic/SegyParser.cs`

### Photogrammetry

#### 3D Reconstruction from Images
Structure-from-motion pipeline.

**Steps:**
1. Feature detection (SIFT/ORB keypoints)
2. Feature matching between images
3. Camera pose estimation
4. Sparse 3D reconstruction
5. Dense depth estimation
6. Point cloud/mesh generation

**Use cases:**
- Outcrop digitization
- Core surface reconstruction
- Volume estimation

**File references:**
- `/Analysis/Photogrammetry/PhotogrammetryPipeline.cs`
- `/Analysis/Photogrammetry/KeypointDetector.cs`
- `/Analysis/Photogrammetry/DepthEstimator.cs`

### CT Image Analysis

#### Segmentation
Partition volumes into materials.

**Tools:**
- Magic Wand (threshold-based region growing)
- Brush (manual painting)
- Lasso (freehand selection)
- Fill (flood fill)

**Workflow:**
1. Load CT volume
2. Select segmentation tool
3. Define material
4. Apply selection to voxels
5. Refine with multiple tools
6. Export segmented volume

**File reference:** `/Data/CtImageStack/Segmentation/`

#### Material Statistics
Quantify segmented materials.

**Metrics:**
- Volume fraction
- Surface area
- Voxel count
- Spatial distribution

#### Thermal Conductivity Estimation
Compute effective thermal conductivity.

**Method:**
- Assign conductivities to materials
- Solve heat equation on voxel grid
- Apply temperature gradient
- Calculate effective property

**File reference:** `/Analysis/ThermalConductivity/ThermalConductivityEstimator.cs`

### Stratigraphic Analysis

#### Borehole Correlation
Align lithology intervals across wells.

**Features:**
- Interactive correlation viewer
- Tie-point definition
- Age/depth model generation
- Sequence identification

**File reference:** `/UI/StratigraphyCorrelationViewer.cs`

### Subsurface GIS

#### Multi-Borehole Geothermal Tools
Spatial analysis for geothermal fields.

**Capabilities:**
- Well spacing optimization
- Thermal interference prediction
- Resource estimation

**File reference:** `/Data/GIS/MultiboreholeGeothermalTools.cs`

---

## GeoScript Scripting Language

### Overview

GeoScript is a domain-specific language for automating geoscience workflows. It provides commands for manipulating datasets, running analyses, and building processing pipelines.

**File reference:** `/Business/GeoScript.cs`

### Syntax

#### Basic Command
```
COMMAND_NAME arg1 arg2 arg3
```

#### WITH-DO Syntax
```
WITH "input_dataset" DO
    OPERATION_NAME param1 param2
TO "output_dataset"
```

#### Pipeline Syntax
```
Dataset |> OPERATION1 |> OPERATION2 |> OutputDataset
```

### Variables

Define variables with `SET`:
```
SET my_variable = 42
SET dataset_name = "CtVolume1"
```

Reference variables with `$`:
```
LOAD_IMAGE $dataset_name
```

### Command Categories

#### Image Commands
- `RESIZE width height` - Resize image
- `CROP x y width height` - Crop region
- `THRESHOLD value` - Binary threshold
- `BLUR radius` - Gaussian blur
- `ROTATE angle` - Rotate image
- `CONVERT_TO_GRAYSCALE` - Remove color
- `EQUALIZE_HISTOGRAM` - Enhance contrast
- `DETECT_EDGES` - Edge detection

#### Table Commands
- `FILTER column operator value` - Filter rows
- `SELECT column1 column2 ...` - Select columns
- `AGGREGATE column function` - Compute statistics
- `JOIN other_table on_column` - Merge tables
- `SORT column order` - Sort rows

#### CT Commands
- `SEGMENT material threshold` - Threshold segmentation
- `EXTRACT_VOLUME x1 y1 z1 x2 y2 z2` - Extract subvolume
- `GENERATE_PNM` - Create pore network
- `CALCULATE_POROSITY` - Compute porosity
- `RENDER_3D` - Generate 3D visualization

#### Borehole Commands
- `EXTRACT_INTERVAL top_depth bottom_depth` - Get depth range
- `CORRELATE other_borehole` - Stratigraphic correlation
- `PLOT_LOG property` - Generate log plot

#### GIS Commands
- `BUFFER distance` - Create buffer zones
- `INTERSECT other_layer` - Spatial intersection
- `UNION other_layer` - Spatial union
- `SELECT_BY_ATTRIBUTE column value` - Attribute query
- `SELECT_BY_LOCATION relation other_layer` - Spatial query

#### PNM Commands
- `CALCULATE_PERMEABILITY direction` - Compute permeability
- `RUN_REACTIVE_TRANSPORT config` - Run transport simulation
- `EXTRACT_NETWORK_STATS` - Get network properties

#### Seismic Commands
- `EXTRACT_TRACE trace_number` - Get single trace
- `APPLY_FILTER filter_type params` - Signal processing
- `COMPUTE_AMPLITUDE` - Amplitude analysis

#### Miscellaneous Dataset Commands
- `LOAD path` - Load dataset from file
- `SAVE path format` - Export dataset
- `COPY` - Duplicate dataset
- `RENAME new_name` - Change name
- `DELETE` - Remove from project

### Example Scripts

#### Example 1: CT Volume Processing
```geoscript
# Load CT volume
LOAD "core_scan.tif" AS "Core1"

# Extract region of interest
WITH "Core1" DO
    EXTRACT_VOLUME 100 100 100 400 400 400
TO "Core1_ROI"

# Segment pore space
WITH "Core1_ROI" DO
    SEGMENT "Pore" 128
TO "Core1_Segmented"

# Generate pore network
WITH "Core1_Segmented" DO
    GENERATE_PNM
TO "Core1_PNM"

# Calculate permeability
WITH "Core1_PNM" DO
    CALCULATE_PERMEABILITY "X"
TO "Permeability_Result"
```

#### Example 2: Multi-Borehole Analysis
```geoscript
# Load borehole data
LOAD "well_A.las" AS "WellA"
LOAD "well_B.las" AS "WellB"

# Extract sandstone intervals
WITH "WellA" DO
    FILTER "Lithology" EQUALS "Sandstone"
TO "WellA_Sandstone"

WITH "WellB" DO
    FILTER "Lithology" EQUALS "Sandstone"
TO "WellB_Sandstone"

# Correlate between wells
WITH "WellA_Sandstone" DO
    CORRELATE "WellB_Sandstone"
TO "Correlation_Result"
```

#### Example 3: Pipeline Processing
```geoscript
# Image processing pipeline
"InputImage"
    |> RESIZE 1024 1024
    |> CONVERT_TO_GRAYSCALE
    |> EQUALIZE_HISTOGRAM
    |> THRESHOLD 127
    |> "ProcessedImage"
```

#### Example 4: Reactive Transport Setup
```geoscript
# Define chemical system
SET temp = 25
SET pressure = 1

# Load PNM
LOAD "network.pnm" AS "Network1"

# Configure reactive transport
WITH "Network1" DO
    RUN_REACTIVE_TRANSPORT {
        species: ["Ca2+", "CO3-2", "H+"],
        minerals: ["Calcite"],
        temperature: $temp,
        time_steps: 1000,
        dt: 0.01
    }
TO "Transport_Results"
```

### Running Scripts

**Method 1: GeoScript Editor**
1. Open Tools > GeoScript Editor
2. Write script in editor
3. Click "Execute"
4. Monitor output in log panel

**Method 2: Load from File**
1. Save script as `.geoscript` file
2. File > Run Script
3. Select script file

**Method 3: Command Line**
```bash
./GeoscientistToolkit --script myscript.geoscript
```

### Error Handling

Scripts report errors with:
- Line number
- Error type (syntax, runtime, type mismatch)
- Descriptive message

Example error:
```
Error at line 15: Dataset "NonExistentData" not found in project
```

---

## Advanced Features

### GPU Acceleration

#### OpenCL Support

GeoscientistToolkit can leverage GPU compute for performance-critical simulations.

**Supported operations:**
- Geothermal heat transport
- Triaxial geomechanical simulation
- Reactive transport solvers

**Setup:**
1. Open Tools > Settings
2. Navigate to Compute section
3. Check "Enable OpenCL"
4. Select device from dropdown
5. Restart application

**File reference:** `/OpenCL/OpenCLDeviceManager.cs`

#### Checking GPU Availability

View available compute devices:
1. Open Tools > System Info
2. Navigate to "Compute Devices" tab
3. See list of OpenCL-capable devices

### Distributed Computing

#### Multi-Node Simulation

Some simulations support distributed execution across multiple machines.

**Setup:**
1. Open Tools > Node Manager
2. Add compute nodes (IP address + port)
3. Configure node properties (CPU cores, memory)
4. Enable distribution in simulation settings

**Supported analyses:**
- Large-scale geothermal simulations
- Seismic forward modeling

**File reference:** `/Network/NodeManager.cs`

### Plugin System

#### Add-Ins

Extend functionality with custom plugins.

**Creating an add-in:**
1. Implement `IAddIn` interface
2. Compile as class library
3. Place DLL in `AddIns/` folder
4. Restart application

**Add-in capabilities:**
- New dataset types
- Custom analysis modules
- Additional file format support
- UI extensions

**File reference:** `/AddIns/IAddIn.cs`

### Material Library Management

#### Importing Material Definitions

Share material properties across projects:
1. Open Tools > Material Library
2. Click "Import"
3. Select material definition file (JSON)
4. Materials added to library

#### Exporting Materials

Save material library:
1. Open Tools > Material Library
2. Select materials to export
3. Click "Export"
4. Save as JSON file

### Compound Library Customization

#### Adding Custom Compounds

Extend thermodynamic database:
1. Open Tools > Compound Library
2. Click "Add Compound"
3. Enter properties:
   - Name
   - Formula
   - Gibbs free energy (ΔGf)
   - Enthalpy (ΔHf)
   - Entropy (S)
   - Heat capacity (Cp)
   - Molar volume
4. Save changes

#### Editing Kinetic Parameters

Modify dissolution/precipitation rates:
1. Select mineral in Compound Library
2. Navigate to "Kinetics" tab
3. Edit rate constant (k25)
4. Edit activation energy (Ea)
5. Set pH dependencies (acid/base catalysis)

**File reference:** `/Business/CompoundLibrary.cs`

### Automation and Batch Processing

#### Processing Multiple Files

Use GeoScript loops (if supported) or external scripting:

**Bash example:**
```bash
for file in *.tif; do
    echo "LOAD \"$file\" AS \"Data\"" > process.geoscript
    echo "WITH \"Data\" DO SEGMENT \"Pore\" 128 TO \"Result\"" >> process.geoscript
    echo "WITH \"Result\" DO SAVE \"${file%.tif}_segmented.tif\"" >> process.geoscript
    ./GeoscientistToolkit --script process.geoscript
done
```

### Project Templates

#### Creating Templates

Save common project configurations:
1. Set up project with typical datasets and settings
2. File > Save As Template
3. Name template
4. Template saved for reuse

#### Using Templates

Start new project from template:
1. File > New from Template
2. Select template
3. Project created with template structure

### Data Export Workflows

#### Exporting for External Software

**TOUGH2 Format:**
For reservoir simulation:
1. Select 3D mesh dataset
2. Right-click > Export
3. Choose "TOUGH2 Format"
4. Configure grid properties
5. Save .mesh file

**OBJ Format:**
For 3D visualization software:
1. Select Mesh3D dataset
2. Right-click > Export
3. Choose "Wavefront OBJ"
4. Include materials option
5. Save .obj file

**Shapefile:**
For GIS software:
1. Select GIS dataset
2. Right-click > Export
3. Choose "ESRI Shapefile"
4. Select coordinate system
5. Save .shp file

### Performance Optimization

#### Memory Management

For large datasets:
1. Unload unused datasets: Right-click > Unload
2. Monitor memory in System Info window
3. Adjust cache settings in Preferences

#### Rendering Performance

Improve viewport responsiveness:
1. Settings > Graphics
2. Reduce sample count for volume rendering
3. Enable level-of-detail (LOD) for meshes
4. Disable shadows for complex scenes

---

## Technical Reference

### System Architecture

#### Application Structure

```
GeoscientistToolkit (Main Application)
│
├── Graphics Layer (Veldrid + ImGui)
│   ├── Window Management
│   ├── Rendering Pipeline
│   └── Input Handling
│
├── UI Layer
│   ├── Main Window
│   ├── Dataset Viewers
│   ├── Tool Panels
│   └── Dialogs
│
├── Business Logic Layer
│   ├── Project Manager (Singleton)
│   ├── GeoScript Engine
│   ├── Compound Library
│   └── Settings Manager
│
├── Data Model Layer
│   ├── Dataset (Abstract Base)
│   ├── 27 Dataset Implementations
│   └── Metadata System
│
├── Analysis Layer
│   ├── 22 Analysis Modules
│   └── Simulation Engines
│
└── I/O Layer
    ├── Data Loaders
    └── Data Exporters
```

#### Key Design Patterns

**Singleton Pattern:**
- ProjectManager: `/Business/ProjectManager.cs`
- Ensures single project state

**Factory Pattern:**
- DatasetUIFactory: `/UI/DatasetUIFactory.cs`
- Creates type-specific UI components

**Strategy Pattern:**
- IDatasetViewer, IDatasetTools
- Polymorphic dataset handling

**Observer Pattern:**
- Dataset change events
- UI update notifications

### Graphics Stack

#### Veldrid Abstraction

Veldrid provides cross-platform graphics:
- **Windows:** Direct3D 11
- **macOS:** Metal
- **Linux:** Vulkan or OpenGL

Backend selection in Settings > Graphics.

#### ImGui Rendering

Immediate-mode UI framework:
- No retained UI tree
- Rebuild UI each frame
- Simple declarative syntax

#### Font Support

Unicode ranges loaded for scientific notation:
- Latin (0x0020-0x00FF)
- Greek (0x0370-0x03FF)
- Mathematical symbols
- Superscripts/subscripts

**File reference:** `/UI/ImGuiController.cs`

### File Format Details

#### .gtp Project Format

ZIP archive structure:
```
project.gtp (ZIP)
├── project.json          # Metadata and dataset registry
├── data/
│   ├── dataset1.bin      # Binary data files
│   ├── dataset2.bin
│   └── ...
└── materials/
    └── materials.json    # Material definitions
```

**project.json schema:**
```json
{
  "name": "Project Name",
  "created": "2025-01-15T10:30:00Z",
  "modified": "2025-01-15T14:20:00Z",
  "datasets": [
    {
      "id": "unique-id",
      "name": "Dataset Name",
      "type": "CtImageStack",
      "dataFile": "data/dataset1.bin",
      "metadata": {
        "sample": "Core-A",
        "location": "Field Site 1"
      }
    }
  ]
}
```

#### Binary Data Encoding

Datasets are serialized to binary for efficiency:
- Headers with type information
- Compressed where beneficial
- Platform-independent byte order (little-endian)

### Thermodynamic Database Format

CompoundLibrary stores compounds as:

```json
{
  "name": "Calcite",
  "formula": "CaCO3",
  "type": "Mineral",
  "molarMass": 100.09,
  "gibbsFreeEnergy": -1128400.0,
  "enthalpy": -1206900.0,
  "entropy": 92.9,
  "heatCapacity": 81.9,
  "molarVolume": 36.93,
  "solubilityProduct": -8.48,
  "kinetics": {
    "rateConstant25C": 1.55e-6,
    "activationEnergy": 41870.0,
    "acidDependence": 0.5,
    "baseDependence": 0.0
  }
}
```

Units:
- Energy: J/mol
- Entropy: J/(mol·K)
- Volume: cm³/mol
- Rate constant: mol/(m²·s)

### Coordinate Systems

#### GIS Coordinate Reference Systems

Supported via ProjNET:
- Geographic (WGS84, NAD83, etc.)
- Projected (UTM, State Plane, etc.)
- Custom projections

Transform between CRS:
```csharp
ICoordinateTransformation transform =
    CoordinateTransformFactory.CreateFromCoordinateSystems(sourceCRS, targetCRS);
```

#### Dataset Local Coordinates

Each 3D dataset has local origin:
- Origin: (0, 0, 0) in dataset space
- Spacing: voxel/cell size in real units
- Extent: physical dimensions

Convert to world coordinates:
```
world_x = origin_x + local_x * spacing_x
world_y = origin_y + local_y * spacing_y
world_z = origin_z + local_z * spacing_z
```

### Numerical Methods

#### Finite Difference Method

Used in heat transport and geomechanics:
- Explicit time stepping
- Second-order central differences for spatial derivatives
- Stability condition (CFL criterion)

#### Network Solvers

Pore network permeability uses:
- Sparse linear system (Ax = b)
- Iterative solvers (Conjugate Gradient)
- Hydraulic conductance formulation

#### Reactive Transport

Coupled PDEs:
- Species transport: ∂C/∂t + ∇·(vC - D∇C) = R
- Reaction rates: R = k·A·(1 - Ω)^n
- Porosity update: ∂φ/∂t = Σ(νᵢ·Vᵢ·Rᵢ)

Operator splitting:
1. Transport step (advection-diffusion)
2. Reaction step (kinetics/equilibrium)

### API Extension Points

#### Creating Custom Dataset Types

Inherit from `Dataset` base class:

```csharp
public class CustomDataset : Dataset
{
    public override DatasetType Type => DatasetType.Custom;

    public override void Load(string filePath)
    {
        // Load data from file
    }

    public override void Unload()
    {
        // Free memory
    }

    public override long GetSizeInBytes()
    {
        // Return memory usage
    }
}
```

Register in `DatasetUIFactory` for UI support.

#### Implementing Analysis Modules

Create analysis class:

```csharp
public class CustomAnalysis
{
    public Dataset Run(Dataset input, Dictionary<string, object> parameters)
    {
        // Perform analysis
        // Create output dataset
        return output;
    }
}
```

Expose through Tools panel or GeoScript command.

### Logging and Debugging

#### Log Levels

The application logs to:
- UI Log Panel (visible to user)
- File: `logs/geoscientist_toolkit.log`

**File reference:** `/Util/Logger.cs`

#### Debug Mode

Enable detailed logging:
1. Settings > Advanced
2. Check "Enable Debug Logging"
3. Restart application

Verbose output includes:
- Method entry/exit
- Variable values
- Timing information

### Platform-Specific Notes

#### Windows
- Preferred graphics: Direct3D 11
- OpenCL typically from NVIDIA/AMD drivers

#### macOS
- Graphics backend: Metal (required on Apple Silicon)
- OpenCL support varies by macOS version
- Unsigned binary may require security exception

#### Linux
- Graphics: Vulkan (preferred) or OpenGL
- Requires OpenCL drivers (Intel/NVIDIA/AMD)
- May need library dependencies: `libskia`, `libgdal`

### Performance Benchmarks

Typical performance (reference hardware: Intel i7, 16GB RAM, NVIDIA GTX 1660):

| Operation | Dataset Size | Time |
|-----------|--------------|------|
| CT Volume Load | 512³ voxels | 2-5 sec |
| PNM Generation | 512³ volume | 30-60 sec |
| Permeability Calc | 10k pores | 5-10 sec |
| Triaxial Sim (CPU) | 100³ elements, 1000 steps | 10-15 min |
| Triaxial Sim (GPU) | 100³ elements, 1000 steps | 2-3 min |
| Geothermal Sim (GPU) | 200³ grid, 10 years | 5-10 min |

### Troubleshooting

#### Graphics Initialization Failure

**Symptom:** Application crashes on startup

**Solution:**
1. Delete `settings.json` to reset graphics backend
2. Run with failsafe mode: `./GeoscientistToolkit --failsafe`
3. Select compatible graphics backend

**File reference:** `/Settings/GraphicsFailsafe.cs`

#### Out of Memory

**Symptom:** Application crashes when loading large datasets

**Solutions:**
- Close unnecessary datasets
- Reduce volume resolution
- Increase system RAM or swap space
- Use 64-bit version

#### OpenCL Not Available

**Symptom:** GPU options grayed out

**Solutions:**
- Install OpenCL drivers for your GPU
- Check System Info for detected devices
- Try updating graphics drivers

#### SEGY Load Failure

**Symptom:** Error loading seismic files

**Solutions:**
- Verify SEGY revision (supports Rev 0, 1)
- Check byte order (big-endian vs little-endian)
- Examine trace headers for corruption

#### Shapefile Not Displaying

**Symptom:** GIS dataset loads but shows no features

**Solutions:**
- Verify coordinate system is defined
- Check if features are outside view extent
- Try reprojecting to WGS84

---

## Conclusion

GeoscientistToolkit provides a comprehensive platform for multi-scale geoscience analysis, from micro-CT pore imaging to basin-scale geothermal modeling. The combination of interactive visualization, GPU-accelerated simulation, and scriptable workflows enables sophisticated research and engineering applications.

### Learning Resources

**Example Projects:**
- Check `/Examples/` folder for sample `.gtp` files
- Included GeoScript examples demonstrate common workflows

**Community:**
- Report issues on project repository
- Request features through issue tracker
- Share custom add-ins and scripts

### Version Information

This guide corresponds to the codebase as of commit `f5063dd`.

Target Framework: .NET 8.0
Graphics: Veldrid 4.9.0
UI: ImGui.NET 1.90.8.1

---

## Author Information

**Author:** Matteo Mangiagalli
**Institution:** Università degli Studi di Urbino Carlo Bo
**Email:** m.mangiagalli@campus.uniurb.it
**Year:** 2025

---

## Citation

If you use GeoscientistToolkit in your research or projects, please cite:

```
Mangiagalli, M. (2025). GeoscientistToolkit: A Comprehensive Platform for
Geoscientific Data Analysis and Simulation. Università degli Studi di Urbino
Carlo Bo. Available at: https://github.com/mattemangia/GeoscientistToolkit
```

BibTeX format:
```bibtex
@software{mangiagalli2025geoscientist,
  author = {Mangiagalli, Matteo},
  title = {GeoscientistToolkit: A Comprehensive Platform for Geoscientific Data Analysis and Simulation},
  year = {2025},
  institution = {Università degli Studi di Urbino Carlo Bo},
  email = {m.mangiagalli@campus.uniurb.it},
  url = {https://github.com/mattemangia/GeoscientistToolkit}
}
```

---

**Document Generated:** 2025-11-17
**Software:** GeoscientistToolkit
**License:** See LICENSE file in repository
